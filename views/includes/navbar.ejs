<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wandervista</title>
<link rel="stylesheet" href="/css/navbar.css">


<script>
  const destinations = <%- citiesByDestinations %>;
  // console.log("Destinations loaded from server:", destinations);
</script>


  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
  rel="stylesheet"
  href="https://cdn.maptiler.com/maptiler-sdk-js/latest/maptiler-sdk.css"
/>

<script
  src="https://cdn.maptiler.com/maptiler-sdk-js/latest/maptiler-sdk.umd.js"
  defer
></script>


<style>
  #suggestion-box li {
    cursor: pointer;
  }
.wandervista a {
  font-family: 'Nunito', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-weight: 700;
  font-size: 1.3rem;
  color: #ff385c; 
  display: flex;
  align-items: center;
  gap: 0.4rem;
  transition: color 0.3s ease;
  cursor: pointer;
  text-decoration: none;
  padding: 0!important;
}

.wandervista .nav-link:hover {
  color: #ff385c;
}

/* Style for the icon inside the link */
.wandervista .nav-link i {
  font-size: 1.5rem;
  color: #ff385c;
  transition: transform 0.3s ease;
}

.wandervista .nav-link:hover i {
  transform: rotate(20deg);
}
.bookings {
  text-decoration: none;
  font-weight: 600;
  font-size: 1rem;
  color: #000;
  padding: 0.4rem 0.8rem; 
  display: inline-block; 
  transition: color 0.3s ease, background-color 0.3s ease, transform 0.3s ease;
  border-radius: 25px;  
  width: fit-content;  
}

.bookings:hover {
  color: #fff;
  background-color: #ff385c;
  cursor: pointer;       
}
.favorites-link {
  display: inline-block;
  padding: 8px 12px;
  color: #000;
  text-decoration: none;
  border-radius: 25px;
  font-weight: 600;
  width: fit-content;
}
.favorites-link:hover{
  background-color: #ffcc00;
}
</style>


</head>
<body>
  <nav class="navbar navbar-expand-md bg-light sticky-top">
  <div class="container-fluid m-0">
    <a class="navbar-brand" href="/listings"><i class="fa-regular fa-compass"></i></a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNavAltMarkup"
      aria-controls="navbarNavAltMarkup"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav wandervista">
        <!-- <a class="nav-link active" aria-current="page" href="/">Home</a> -->
        <a class="nav-link" href="/listings">WanderVista</a>
      </div>

<div class="navbar-nav ms-auto position-relative" style="z-index: 1;">
  <div class="position-relative" style="width: 100%;">

<form class="d-flex position-relative w-100" role="search" action="/search" method="GET" id="searchForm">
  <div class="position-relative w-100">
    <div class="position-relative">
      <input
        type="text"
        id="btn-search-input"
        name="city"
        class="form-control form-control custom-search"
        placeholder="Search destination..."
        autocomplete="off" 
      />
      <ul id="suggestion-box" class="list-group position-absolute w-100 mt-1" style="display:none; z-index:1000; max-height: 300px; overflow-y: auto;"></ul>
    </div>
  </div>
  <button class="btn airbnb-outline-btn ms-2" id="btn-search" type="submit">
    <i class="fa-solid fa-magnifying-glass"></i> Search
  </button>
</form>



    <div id="dropdownPanel"
         class="border p-3 bg-white shadow rounded position-absolute end-0"
         style="display: none; z-index: 1000; min-width: 250px; top: 100%;">
      <div class="mb-2">
        <label for="countrySelect" class="form-label">Country</label>
        <select class="form-select" id="countrySelect">
    <option value="">Select Country</option>
    <% 
      const countries = JSON.parse(citiesByCountry);
      for (const country in countries) { 
    %>
      <option value="<%= country %>"><%= country %></option>
    <% } %>
  </select>
      </div>
      <div>
        <label for="citySelect" class="form-label">City</label>
        <select class="form-select" id="citySelect">
          <option value="">Select City</option>
        </select>
      </div>
    </div>
  </div>
</div>


<div class="navbar-nav ms-auto">
<a class="nav-link add-home-btn" href="/listings/new">Add your home</a>

 
<div class="menu-container">
  <button id="menu-toggle" aria-label="Toggle menu">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
  </button>

  <div class="auth-dropdown" id="auth-dropdown">
    <% if(!currUser) { %>
      <a class="nav-link active auth-btn" aria-current="page" href="/signup">Sign Up</a>
      <a class="nav-link auth-btn" href="/login">Log In</a>
    <% } else { %>
       <span>ðŸ‘¤ <%= currUser.username %></span>
      <a class="nav-link auth-btn" href="/logout">Log Out</a>
      <a href="/bookings" class="bookings">Bookings!</a>
<a href="/listings/favorites" class="favorites-link">Saved Items</a>

    <% } %>
  </div>
</div>
</div>
    </div>
    </div>
  </div>
</nav>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/navbar.js" defer></script>
</body>
</html>


<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>


<script src="./utils/fuse.js"></script>
<script>
  document.getElementById("menu-toggle").addEventListener("click", function () {
    const dropdown = document.getElementById("auth-dropdown");
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggle = document.getElementById("userDropdownToggle");
    const menu = document.getElementById("userDropdownMenu");

    function isMobile() {
      return window.innerWidth <= 767;
    }

    if (toggle && menu) {
      toggle.addEventListener("click", function () {
        if (isMobile()) {
          menu.style.display = menu.style.display === "block" ? "none" : "block";
        }
      });

      document.addEventListener("click", function (e) {
        if (isMobile() && !toggle.contains(e.target) && !menu.contains(e.target)) {
          menu.style.display = "none";
        }
      });
    }
  });
</script>
